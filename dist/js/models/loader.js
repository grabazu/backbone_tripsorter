define(["backbone","models/city","models/destination","models/deal","collections/cityList","collections/tripLoaderDealList"],function(e,t,i,n,s,a){var r=e.Model.extend({defaults:{ready:!1},initialize:function(){var e=this,n=new s,r=new a;r.getDeals().success(function(s){_.each(s.deals,function(e){var s=new t({name:e.departure});s=n.insert(s);var a=new i({name:e.arrival});a=s.getDestinations().insert(a),a.addDeal(e)}),e.set("cities",n),e.set("ready",!0)})},getCities:function(){return this.get("cities")},getTrip:function(e,t,i){return this.get("cities").getTrip(e,t,i)},getReady:function(){return this.get("ready")}});return r});